<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Getting started with Istio Service Mesh - Part 1 | HPE Express Containers</title>
    <meta name="description" content="Istio Service Mesh - Part 1 Deploying Istio">
    
    
    <link rel="preload" href="/Docker-SimpliVity/assets/css/styles.1e09661f.css" as="style"><link rel="preload" href="/Docker-SimpliVity/assets/js/app.1e09661f.js" as="script"><link rel="preload" href="/Docker-SimpliVity/assets/js/38.5d75c20c.js" as="script"><link rel="prefetch" href="/Docker-SimpliVity/assets/css/24.styles.3f1a8cd4.css"><link rel="prefetch" href="/Docker-SimpliVity/assets/css/9.styles.d80f99dc.css"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/1.1ee0df0d.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/10.0519dfb7.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/100.7e7c797a.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/101.ceb496f3.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/102.ef4cd22f.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/103.04bb1d8f.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/104.bdbf87f6.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/105.8ddc2675.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/106.5eb7369f.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/107.6ee04838.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/108.f6775cf6.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/109.0bae7c07.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/11.e2bfaf3a.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/110.f8a83ac8.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/111.2c0a8ae3.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/12.f4645ffc.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/13.270fa099.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/14.ede0b9eb.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/15.9bd2b4e1.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/16.31ccd8d9.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/17.0f752102.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/18.6d3053de.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/19.769c4847.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/2.02d73b64.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/20.dedc9e53.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/21.caf68c74.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/22.66dec517.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/23.5059caa6.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/24.3f1a8cd4.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/25.87a5e54b.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/26.c9034f20.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/27.9d5d8050.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/28.5a3b67ad.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/29.489b60c2.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/3.c135f3df.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/30.01f5a9be.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/31.911bdebc.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/32.f056b105.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/33.9c125410.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/34.6b7aa929.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/35.4200090e.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/36.1478c050.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/37.2e3af121.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/39.7bb9cb9e.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/4.8ed2ab3d.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/40.a6c08d31.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/41.cf474b58.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/42.63d764b7.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/43.cdbffe6f.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/44.8d5c070b.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/45.d1c8e105.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/46.7b50d4ff.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/47.6dbd847f.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/48.90427520.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/49.cc6d8b0e.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/5.916c2ac0.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/50.64f641a8.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/51.84466be5.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/52.dee86026.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/53.f35b18c4.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/54.6692960c.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/55.fcec21db.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/56.648b3acc.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/57.0da832fd.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/58.1bc67f8b.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/59.087dcff8.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/6.c80f761b.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/60.b64416b9.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/61.90291322.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/62.b3cc64d4.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/63.10a38df4.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/64.50afc39a.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/65.2c9c590d.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/66.c45403f3.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/67.65a32d01.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/68.1f5bc42d.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/69.3b2d57e7.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/7.7584fb60.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/70.13f7d909.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/71.62883c10.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/72.b197fc1c.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/73.a1bec660.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/74.1f803515.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/75.b05f6f42.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/76.8f320b11.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/77.0834e4f3.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/78.2b73a088.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/79.e1885384.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/8.36ebe21b.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/80.205430cd.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/81.49d55050.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/82.2720c2f8.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/83.b025f0cf.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/84.6fb0f73a.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/85.63ca60aa.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/86.c041d43c.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/87.4a29ed14.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/88.16b9d595.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/89.ff3ac337.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/9.d80f99dc.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/90.6fdc6256.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/91.b665001c.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/92.e85caa7d.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/93.9cd2296d.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/94.44c498cf.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/95.e4a9dc4a.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/96.5532531b.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/97.d2248b01.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/98.5979847e.js"><link rel="prefetch" href="/Docker-SimpliVity/assets/js/99.1e13b8e5.js">
    <link rel="stylesheet" href="/Docker-SimpliVity/assets/css/24.styles.3f1a8cd4.css"><link rel="stylesheet" href="/Docker-SimpliVity/assets/css/9.styles.d80f99dc.css"><link rel="stylesheet" href="/Docker-SimpliVity/assets/css/styles.1e09661f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Docker-SimpliVity/" class="home-link router-link-active"><!----> <span class="site-name">HPE Express Containers</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Docker-SimpliVity/" class="nav-link">Home</a></div><div class="nav-item"><a href="/Docker-SimpliVity/blog/" class="nav-link router-link-active">Blog</a></div> <a href="https://github.com/HewlettPackard/Docker-Simplivity" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Docker-SimpliVity/" class="nav-link">Home</a></div><div class="nav-item"><a href="/Docker-SimpliVity/blog/" class="nav-link router-link-active">Blog</a></div> <a href="https://github.com/HewlettPackard/Docker-Simplivity" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading open"><span>Introduction</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/Docker-SimpliVity/introduction.html" class="sidebar-link">Executive Summary</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Release notes</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Solution overview</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Solution components</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Preparing the environment</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Configuring the core components</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Overview of the playbooks</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Deploying core components</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Post deployment</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Configuring Storage</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Deploying Windows workers</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Deploying Sysdig monitoring</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Deploying Splunk</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Deploying Prometheus and Grafana on Kubernetes</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Deploying Prometheus and Grafana on Docker Swarm</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Backup and restore</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Solution lifecycle management</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Appendices</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="getting-started-with-istio-service-mesh-part-1-deploying-istio"><a href="#getting-started-with-istio-service-mesh-part-1-deploying-istio" aria-hidden="true" class="header-anchor">#</a> Getting started with Istio Service Mesh - Part 1 Deploying Istio</h1> <h2 id="introduction-to-service-meshes"><a href="#introduction-to-service-meshes" aria-hidden="true" class="header-anchor">#</a> Introduction to service meshes</h2> <p>A Microservice Architecture breaks up the monolith into many smaller pieces that are composed together. Patterns to secure the communication between services like fault tolerance (via timeout, retry, circuit breaking, etc.) have been developed. A service mesh can now provide these services on a platform level and frees the application writers from those tasks. Routing decisions are done at the mesh level. Distributed tracing is used to see where calls are going in the microservice topology.</p> <h2 id="prerequisites"><a href="#prerequisites" aria-hidden="true" class="header-anchor">#</a> Prerequisites</h2> <ul><li>Install the <code>kubectl</code> binary on your Ansible box</li> <li>Download the UCP Client bundle for the <code>admin</code> user. Ensure that you have configured the bundle in your terminal.<div class="language- extra-class"><pre class="language-text"><code># cd ~/certs.hpe-ucp01.admin/
# eval &quot;$(&lt;env.sh)&quot;
Cluster &quot;ucp_hpe-ucp01.cloudra.local:6443_admin&quot; set.
User &quot;ucp_hpe-ucp01.cloudra.local:6443_admin&quot; set.
Context &quot;ucp_hpe-ucp01.cloudra.local:6443_admin&quot; modified.
</code></pre></div></li> <li>Confirm that you can connect to the cluster by running a test command, for example, <code>kubectl get nodes</code></li></ul> <h2 id="installing-istio"><a href="#installing-istio" aria-hidden="true" class="header-anchor">#</a> Installing Istio</h2> <p>Download the installation file from the GitHub site and set up your <code>PATH</code> variable:</p> <div class="language- extra-class"><pre class="language-text"><code>cd ~
curl -L https://git.io/getLatestIstio | ISTIO_VERSION=1.1.5 sh -
export PATH=&quot;$PATH:/root/istio-1.1.5/bin&quot;
</code></pre></div><p>Check that <code>istioctl</code> is available:</p> <div class="language- extra-class"><pre class="language-text"><code># which istioctl

/root/istio-1.1.5/bin/istioctl

# istioctl version

version.BuildInfo{Version:&quot;1.1.5&quot;, GitRevision:&quot;9b6d31b74d1c0cc9358cc82d395b53f71393326b&quot;, User:&quot;root&quot;, Host:&quot;3e29fde4-6c3f-11e9-b00d-0a580a2c0205&quot;, GolangVersion:&quot;go1.10.4&quot;, DockerHub:&quot;docker.io/istio&quot;, BuildStatus:&quot;Clean&quot;, GitTag:&quot;1.1.4-10-g9b6d31b&quot;}
</code></pre></div><p>Install all the Istio Custom Resource Definitions (CRDs) using <code>kubectl apply</code>, and wait a few seconds for the CRDs to be committed in the Kubernetes API-server:</p> <div class="language- extra-class"><pre class="language-text"><code>cd ~/istio-1.1.5
for i in install/kubernetes/helm/istio-init/files/crd*yaml; do kubectl apply -f $i; done
</code></pre></div><p>Enforce mutual TLS authentication between all clients and servers.  This variant should only be used on a
fresh Kubernetes cluster where all workloads will be Istio-enabled. All newly deployed workloads will have Istio
sidecars installed. (If installing on an existing cluster, use the playbook <code>install/kubernetes/istio-demo.yaml</code>
the permissive mutual TLS mode, where all services accept both plain text and mutual TLS traffic)</p> <div class="language- extra-class"><pre class="language-text"><code>kubectl apply -f install/kubernetes/istio-demo-auth.yaml
</code></pre></div><p>You will probably see the error:</p> <div class="language- extra-class"><pre class="language-text"><code>The Service &quot;istio-ingressgateway&quot; is invalid: spec.ports[0].nodePort: Invalid value: 31380: provided port is not in the valid range. The range of valid ports is 32768-35535
</code></pre></div><p>You need to modify a number of ports used so that they are in the valid range:</p> <div class="language- extra-class"><pre class="language-text"><code>find ./ -type f -exec sed -i 's/31380/33380/g' {} \;
find ./ -type f -exec sed -i 's/31390/33390/g' {} \;
find ./ -type f -exec sed -i 's/31400/33400/g' {} \;
</code></pre></div><p>Re-apply, using the modified file:</p> <div class="language- extra-class"><pre class="language-text"><code>kubectl apply -f install/kubernetes/istio-demo-auth.yaml
</code></pre></div><p>Use <code>kubectl get pods</code> and wait until all the required pods are running:</p> <div class="language- extra-class"><pre class="language-text"><code># kubectl get pods -n istio-system
NAME                                      READY     STATUS      RESTARTS   AGE
grafana-7d46986779-8nbqv                  1/1       Running     0          12m
istio-citadel-7476b85687-5kfcl            1/1       Running     0          12m
istio-cleanup-secrets-m9rbp               0/1       Completed   0          13m
istio-egressgateway-7b6b576cfc-x8mkv      1/1       Running     0          12m
istio-galley-5d5f7f896b-5xpv4             1/1       Running     0          12m
istio-grafana-post-install-6b4bf          0/1       Completed   3          13m
istio-ingressgateway-7df9bdbf56-g6mtp     1/1       Running     0          12m
istio-pilot-5dc49bbdc6-gb4sl              2/2       Running     0          12m
istio-policy-85f58fb8b6-rgxgw             2/2       Running     0          12m
istio-security-post-install-v72lm         0/1       Completed   2          13m
istio-sidecar-injector-7d6d989cc8-jz7z5   1/1       Running     0          12m
istio-telemetry-85fd5c7d97-crdbm          2/2       Running     1          12m
istio-tracing-7bc6d6476b-h47v5            1/1       Running     0          12m
prometheus-77bbf67664-gnv68               1/1       Running     0          12m
servicegraph-664d5975cf-dkmkt             1/1       Running     0          12m
</code></pre></div><h2 id="set-up-nodeport-for-each-service"><a href="#set-up-nodeport-for-each-service" aria-hidden="true" class="header-anchor">#</a> Set up NodePort for each service</h2> <p>Use <code>kubectl get svc</code> to inspect the services:</p> <div class="language- extra-class"><pre class="language-text"><code># kubectl get svc -n istio-system
NAME                     TYPE           CLUSTER-IP      EXTERNAL-IP   PORT(S) 
grafana                  ClusterIP      10.96.183.82    &lt;none&gt;        3000/TCP 
istio-citadel            ClusterIP      10.96.7.153     &lt;none&gt;        8060/TCP,15014/TCP
istio-egressgateway      ClusterIP      10.96.12.233    &lt;none&gt;        80/TCP,443/TCP,15443/TCP 
istio-galley             ClusterIP      10.96.27.192    &lt;none&gt;        443/TCP,15014/TCP,9901/TCP
istio-ingressgateway     LoadBalancer   10.96.26.105    &lt;pending&gt;     15020:33459/TCP,80:33380/TCP,443:33390/TCP,33400:33400/TCP,15029:35354/TCP,15030:35380/TCP,15031:35113/TCP,15032:34307/TCP,15443:33202/TCP
istio-pilot              ClusterIP      10.96.179.134   &lt;none&gt;        15010/TCP,15011/TCP,8080/TCP,15014/TCP
istio-policy             ClusterIP      10.96.105.251   &lt;none&gt;        9091/TCP,15004/TCP,15014/TCP          
istio-sidecar-injector   ClusterIP      10.96.15.99     &lt;none&gt;        443/TCP           
istio-telemetry          ClusterIP      10.96.136.207   &lt;none&gt;        9091/TCP,15004/TCP,15014/TCP,42422/TCP
jaeger-agent             ClusterIP      None            &lt;none&gt;        5775/UDP,6831/UDP,6832/UDP
jaeger-collector         ClusterIP      10.96.2.225     &lt;none&gt;        14267/TCP,14268/TCP      
jaeger-query             ClusterIP      10.96.15.223    &lt;none&gt;        16686/TCP         
kiali                    ClusterIP      10.96.28.157    &lt;none&gt;        20001/TCP         
prometheus               ClusterIP      10.96.145.238   &lt;none&gt;        9090/TCP          
tracing                  ClusterIP      10.96.119.30    &lt;none&gt;        80/TCP            
zipkin                   ClusterIP      10.96.245.224   &lt;none&gt;        9411/TCP          
</code></pre></div><p>You can set up NodePorts to make it easier to access some of the services such as Prometheus (on port 33090), Grafana (33030), Jaeger (33086) and Kiali (33001):</p> <div class="language- extra-class"><pre class="language-text"><code>kubectl -n istio-system patch svc prometheus   --type='json' -p '[{&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/spec/type&quot;,&quot;value&quot;:&quot;NodePort&quot;}]'
kubectl -n istio-system patch svc prometheus   --type='json' -p '[{&quot;op&quot;: &quot;add&quot;, &quot;path&quot;:&quot;/spec/ports/0/nodePort&quot;, &quot;value&quot;:33090}]'
kubectl -n istio-system patch svc grafana --type='json' -p '[{&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/spec/type&quot;,&quot;value&quot;:&quot;NodePort&quot;}]'
kubectl -n istio-system patch svc grafana --type='json' -p '[{&quot;op&quot;: &quot;add&quot;, &quot;path&quot;:&quot;/spec/ports/0/nodePort&quot;, &quot;value&quot;:33030}]'
kubectl -n istio-system patch svc jaeger-query --type='json' -p '[{&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/spec/type&quot;,&quot;value&quot;:&quot;NodePort&quot;}]'
kubectl -n istio-system patch svc jaeger-query --type='json' -p '[{&quot;op&quot;: &quot;add&quot;, &quot;path&quot;:&quot;/spec/ports/0/nodePort&quot;, &quot;value&quot;:33086}]'
kubectl -n istio-system patch svc kiali --type='json' -p '[{&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/spec/type&quot;,&quot;value&quot;:&quot;NodePort&quot;}]'
kubectl -n istio-system patch svc kiali --type='json' -p '[{&quot;op&quot;: &quot;add&quot;, &quot;path&quot;:&quot;/spec/ports/0/nodePort&quot;, &quot;value&quot;:33001}]'
</code></pre></div><h2 id="admission-registration"><a href="#admission-registration" aria-hidden="true" class="header-anchor">#</a> Admission registration</h2> <p>Verify that Kubernetes api-server supports admission registration:</p> <div class="language- extra-class"><pre class="language-text"><code># kubectl api-versions | grep admissionregistration

admissionregistration.k8s.io/v1alpha1
admissionregistration.k8s.io/v1beta1
</code></pre></div><p>Verify sidecar injector deployment:</p> <div class="language- extra-class"><pre class="language-text"><code># kubectl -n istio-system get deployment -l istio=sidecar-injector

NAME                     DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
istio-sidecar-injector   1         1         1            1           22m
</code></pre></div><p>Label the default namespace for automatic sidecar injection:</p> <div class="language- extra-class"><pre class="language-text"><code># kubectl label namespace default istio-injection=enabled

namespace/default labeled
</code></pre></div><p>Check that the label has been applied for the default namespace:</p> <div class="language- extra-class"><pre class="language-text"><code># kubectl get namespace -L istio-injection

NAME           STATUS    AGE       ISTIO-INJECTION
default        Active    2d        enabled
istio-system   Active    22m       disabled
kube-public    Active    2d
kube-system    Active    2d
</code></pre></div><p>Now you are ready to install the reference BookInfo application for Istio.</p></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/HewlettPackard/Docker-Simplivity/edit/devel/docs-src/blog/istio-getting-started-1.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <!----> </div> <!----></div></div>
    <script src="/Docker-SimpliVity/assets/js/38.5d75c20c.js" defer></script><script src="/Docker-SimpliVity/assets/js/app.1e09661f.js" defer></script>
  </body>
</html>
